---
date: 2025-5-14
sidebar: false
---

import { BlogAvatar, CodeFold } from '@lynx';
import { PackageManagerTabs } from '@theme';
import { Go, Badge } from '@lynx';
import { Tab, Tabs } from '@rspress/core/theme';

_2025 年 7 月 15 日_

# LynxRecorder: Lynx 专属摄影师

<BlogAvatar list={['zhaosong', 'zhangfacheng', 'lynx']} />

![lynx-recorder-background](https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/plugin/static/lynx-recorder-banner.svg)

今天，向大家介绍一款 Lynx 自研的录制回放引擎- LynxRecorder 。

就像生活中的摄影师用镜头记录美好瞬间，LynxRecorder 是 Lynx 的专属“摄影师”，它能精准录制开发者开发的页面，生成可回放的 “胶卷”。

是简单的视频录制吗？不！更进一步，LynxRecorder 提供的是一种 “完美回放”，回放阶段不仅仅保证了 UI 的完整性和渲染数据的一致性，同时保留了页面的交互功能 ，甚至页面感知到的时间都和录制阶段保持一致。

可以跨设备回放吗？当然！LynxRecorder 提供了一个通用的驱动 (Replay) 进行 “胶卷” 解码，只要你的设备接入了该驱动，可以不用关心设备型号，将 iPad 录制的 “胶卷” 借助 iPhone 进行回放，也可以跨操作系统，将 Android 的 “胶卷” 用于 iOS。如果你的 PC 或者 TV 等非移动端设备也已经使用 Lynx 开发，那 “胶卷” 对于他们来说也是可用的。

## 设计初衷

### 更快速的问题定位

如果你正在使用 Lynx 开发自己应用，随着功能的逐渐增加，你的页面将逐渐的与自己的应用环境耦合起来。例如，你的 Lynx 页面依赖自己应用中特殊定制的 NativeModule，或者页面依赖自己的云服务管理资源以及数据。

此时如果你遇到棘手的问题，需要寻求别人帮助，要是问题足够简单，那通过简单的沟通或者源码查阅就可以解决。如果没有这么幸运，我们往往期望通过源代码调试去辅助定位问题，相信我，真正棘手的问题来了，想要帮你解决这个问题的热心人可能会因为你的页面与你私有环境的高度耦合而焦头烂额，编译失败 、认证失败 、环境差异等问题也紧跟而来。

LynxRecorder 的设计初衷就是为了去除 Lynx 页面与私有环境的耦合，从而加速问题排查过程。得益于 LynxRecorder 的 “胶卷” 存储了页面所需的全部信息，这使得回放阶段不需要进行任何的外部请求，从而摆脱对私有环境的依赖。

使用 LynxRecorder 辅助排查问题，无需编译原始应用，无需配置复杂的认证流程，无需关注开发环境差异。只需要提供一份 “胶卷” 即可，对方可以在任何接入 Replay 驱动的设备上对场景进行回放，进而定位问题。

### 更丰富的测试场景

在日常的开发中，我们代码合入到被用户实际使用之间存在延迟，这使得一些细微的问题，尤其是那些和具体业务场景相关的问题较晚暴露出来，而且往往这些问题都是以一个非常紧急的状态暴露出来。此时面对着火急火燎的客户以及冗长的提交历史，你肯定会恨自己为什么没有早点发现。

LynxRecorder 凭借自己 “摄影师” 的身份，将大量的实际应用场景记录下来，并在日常开发阶段通过回放来验证更改会不会带来实际场景中的异常，可以更快更早的暴露代码变更带来的潜在风险。

## 录制原理

Lynx 整个页面渲染是多方面共同作用的结果，从整体来看，一方面来自于 Lynx 内部各个模块之间的紧密配合，完成从 DSL -> VDom -> DrawList 的整个过程，另一方面来自于应用与 Lynx 之间的数据通信。

Lynx 内部模块之间的联动由 Lynx Engine 自身的实现来驱动，是不被外部感知的，相对稳定黑盒。应用与 Lynx 的数据通信则完全由应用开发者实现，不同开发者之间的逻辑各不相同。

LynxRecorder 设计目标之一就是屏蔽不同应用与 Lynx 数据通信的差异，从而实现 Lynx 页面的跨应用、跨设备乃至跨平台回放。

录制阶段，LynxRecorder 模块会悄悄的记录下你的应用与 Lynx 之间所有的数据通信序列，这些记录信息最终会被打包成录制产物。

回放阶段，LynxRecorder 借助于录制阶段记录的数据，自己承担起应用的角色与 Lynx 进行数据通信。

<div
  style={{
    display: 'flex',
    justifyContent: 'center',
    alignItems: 'center',
    gap: '20px',
  }}
>
<img
  src="https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/plugin/static/recorder-principle-record.svg" alt="recorder-principle-record"
/>

<img
  src="https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/plugin/static/recorder-principle-replay.svg"
  alt="recorder-principle-replay"
/>

</div>

---

_感谢[黄玄](https://x.com/huxpro)、[张磊](https://x.com/zoolsher)和[刘守群](https://x.com/liushouqun)在撰写此博客时提供的帮助。_
