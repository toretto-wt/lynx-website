<style>{`
  .full_image {
    width: 750px;
    margin: 20px;
  }
`}</style>

import { Steps } from '@theme';
import * as NextSteps from '@lynx/NextSteps';

# 分析 JavaScript 执行性能

Trace 支持录制详细的 JavaScript Profile 数据，方便你分析后台线程脚本的执行性能。

<Steps>

### 1. 点击 JS Profile 并选择对应的脚本引擎类型

根据后台线程脚本引擎类型选择正确的选项：

- disable：不开启；
- primjs：开启 PrimJS 引擎的 Profile；
- v8：开启 V8 引擎的 Profile。

<img
  src="https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/plugin/static/choose-js-profile-type-latest.png"
  alt="选择 JS Profile 类型"
  className="full_image"
/>

### 2. 开始录制

点击 Start 按钮，开始录制 Trace 数据。

<img
  src="https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/plugin/static/start-js-profile-trace-latest.png"
  alt="开始录制 JS Profile"
  className="full_image"
/>

### 3. 停止录制

点击 Stop 按钮，结束录制 Trace 数据。

<img
  src="https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/plugin/static/stop-js-profile-trace-latest.png"
  alt="停止录制 JS Profile"
  className="full_image"
/>

### 4. 使用 sourcemap 反解 JavaScript Profile 数据（可选）

如果 scripts 被[压缩](/api/rspeedy/rspeedy.minify.js)，可以使用 [sourcemap](/api/rspeedy/rspeedy.sourcemap.js) 反解堆栈:

<img
  src="https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/plugin/static/sourcemap-decode.gif"
  alt="反解 JavaScript Profile"
  className="full_image"
/>

</Steps>

### 常见问题

##### 录制 Trace 后没有 JavaScript Profile 数据

- 请确保在开始录制前选择了正确的后台脚本引擎类型;
- 若使用 iOS 设备，请确保开启 Lynx Devtool 和 [PrimJS 调试开关](/guide/start/integrate-lynx-devtool-advanced)。

##### 点击 SourceMap Decode 后未找到脚本

- 请确保在打开 Lynx 页面前开始录制 Trace，以确保获取脚本的名称;
